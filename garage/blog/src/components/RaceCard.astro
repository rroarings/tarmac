---
// Define the props that this component accepts
import type { CollectionEntry } from "astro:content";
import FormattedDate from "./FormattedDate.astro";

interface Props {
  race: CollectionEntry<"races">;
}

const { race } = Astro.props;

// Extract a slug from the file path (last part without extension)
const parts = race.id.split("/");
const raceSlug = parts[parts.length - 1].replace(/\.(md|mdx)$/, "");
---

<a href={`/seasons/${race.data.season}/races/${raceSlug}`} class="block h-full">
  <div
    class="bg-white border border-gray-300 rounded shadow-md overflow-hidden hover:shadow-lg transition-shadow h-full"
  >
    <img
      src={race.data.trackImage || "/blog-placeholder-4.jpg"}
      alt={race.data.trackName}
      class="w-full h-56 object-cover p-3"
    />
    <div class="p-6">
      <p class="text-sm text-gray-500 mb-1">Race #{race.data.raceNumber}</p>

      <h3 class="text-xl font-bold mb-2">{race.data.trackName}</h3>
      <p class="text-gray-600 mb-3">{race.data.location}</p>

      <div class="text-sm text-gray-600">
        <div class="flex justify-between items-center mb-1">
          <span>Date:</span>
          <span><FormattedDate date={race.data.date} /></span>
        </div>

        {
          race.data.completed && (
            <>
              <div class="flex justify-between items-center mb-1">
                <span>Winner:</span>
                <span>{race.data.winner}</span>
              </div>
              <div class="flex justify-between items-center">
                <span>Fastest Lap:</span>
                <span>{race.data.fastestLapTime}</span>
              </div>
            </>
          )
        }

        {
          !race.data.completed && (
            <div class="mt-2">
              <span class="px-2 py-1 rounded bg-gray-200 text-gray-700 text-xs">
                Upcoming
              </span>
            </div>
          )
        }
      </div>
    </div>
  </div>
</a>
